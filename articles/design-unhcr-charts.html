<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Designing UNHCR Branded Charts using unhcrthemes • unhcrthemes</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Lato-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Designing UNHCR Branded Charts using unhcrthemes">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">unhcrthemes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/unhcrthemes.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/design-unhcr-charts.html">Designing UNHCR Branded Charts using unhcrthemes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/unhcr-dataviz/unhcrthemes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Designing UNHCR Branded Charts using unhcrthemes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/unhcr-dataviz/unhcrthemes/blob/master/vignettes/articles/design-unhcr-charts.Rmd" class="external-link"><code>vignettes/articles/design-unhcr-charts.Rmd</code></a></small>
      <div class="d-none name"><code>design-unhcr-charts.Rmd</code></div>
    </div>

    
    
<p>Data visualization is a powerful tool for conveying information and
insights from complex datasets. The <a href="https://www.unhcr.org/" class="external-link">United Nations High Commissioner for
Refugees</a> (UNHCR) provides crucial <a href="https://www.unhcr.org/refugee-statistics/download/" class="external-link">refugee
statistics</a> that can be presented in an informative and visually
appealing manner. The <a href="https://github.com/unhcr-dataviz/unhcrthemes" class="external-link">unhcrthemes</a> package, in combination
with the <a href="https://populationstatistics.github.io/refugees/" class="external-link">refugees</a> package and the versatile
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> library, offers an excellent solution to create
UNHCR-branded charts with ease.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Before we start creating UNHCR branded charts, make sure you have the
<strong>necessary packages installed</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install CRAN packages</span></span>
<span><span class="va">packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"refugees"</span>, <span class="st">"tidyverse"</span>, <span class="st">"scales"</span>, <span class="st">"ragg"</span>, <span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">packages</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install unhcrthemes with pak</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"unhcr-dataviz/unhcrthemes"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Load the packages</strong> into your R environment:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/unhcr-dataviz/unhcrthemes" class="external-link">unhcrthemes</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://populationstatistics.github.io/refugees/" class="external-link">refugees</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<p>Some packages installed above will be loaded using the
<code>::</code> notation to make the code and intentions clearer.</p>
<p>For this tutorial, we’ll use statistics provided by UNHCR. The
refugee package allows us to access and work with this data. You can
find more information on the datasets available and the use of the
<a href="https://populationstatistics.github.io/refugees/" class="external-link">refugees</a> package in <a href="https://www.unhcr.org/refugee-statistics/insights/explainers/refugees-r-package.html" class="external-link">this
blog post</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set caption for all charts, as we will only use the refugees package</span></span>
<span><span class="va">caption</span> <span class="op">&lt;-</span> <span class="st">"Source: Refugee Data Finder&lt;br&gt;© UNHCR, The UN Refugee Agency"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="bar-chart">Bar chart<a class="anchor" aria-label="anchor" href="#bar-chart"></a>
</h2>
<div class="section level3">
<h3 id="single-bar-chart">Single bar chart<a class="anchor" aria-label="anchor" href="#single-bar-chart"></a>
</h3>
<p>Let’s start by creating a simple bar chart to visualize the top 10
refugee and other people in need of international protection by country
of origin in 2022.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep only 2022 records, Sum refugees and oip,</span></span>
<span><span class="co"># Keep only top 10, Wrap long label</span></span>
<span><span class="va">bar_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    refugees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">oip</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">coo_name</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">refugees</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>coo_name <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span><span class="va">coo_name</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title and subtitle</span></span>
<span><span class="va">title_bar</span> <span class="op">&lt;-</span> <span class="st">"Refugees and other people in need of international protection"</span></span>
<span><span class="va">subtitle_bar</span> <span class="op">&lt;-</span> <span class="st">"By country of origin at the end of 2022"</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">bar_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">refugees</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">coo_name</span>, <span class="va">refugees</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.8</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7e6</span>, by <span class="op">=</span> <span class="fl">1e6</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_bar</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="va">subtitle_bar</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of people"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"X"</span>, axis <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/bar-plot-1.png" width="100%"></p>
<p><strong>Plot with labels:</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with labels</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">bar_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">refugees</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">coo_name</span>, <span class="va">refugees</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.8</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span></span>
<span>        scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_si</a></span><span class="op">(</span>unit <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>        accuracy <span class="op">=</span> <span class="fl">.1</span></span>
<span>      <span class="op">)</span><span class="op">(</span><span class="va">refugees</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="op">-</span><span class="fl">.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_bar</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="va">subtitle_bar</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="cn">FALSE</span>, axis <span class="op">=</span> <span class="st">"Y"</span>, axis_text <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/bar-label-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="grouped-bar-chart">Grouped bar chart<a class="anchor" aria-label="anchor" href="#grouped-bar-chart"></a>
</h3>
<p>Let’s compare the refugee population originating in each UNHCR region
for both 2012 and 2022. We will use a grouped bar chart.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep 2012 and 2022 records, Load and join region names,</span></span>
<span><span class="co"># Group by year and region and sum refugees,</span></span>
<span><span class="co"># Wrap long label, Remove NA</span></span>
<span><span class="va">group_bar_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2012</span> <span class="op">|</span> <span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/countries.html" class="external-link">countries</a></span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coo_iso"</span> <span class="op">=</span> <span class="st">"iso_code"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">unhcr_region</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>refugees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>unhcr_region <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span><span class="va">unhcr_region</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">unhcr_region</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title and subtitle</span></span>
<span><span class="va">title_group_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"Comparison of the total refugee population in &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span>, <span class="st">"pal_blue"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  <span class="st">"'&gt;2012&lt;/span&gt; and &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span>, <span class="st">"pal_blue"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  <span class="st">"'&gt;2022&lt;/span&gt; by region of origin"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">group_bar_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">refugees</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">unhcr_region</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    width <span class="op">=</span> <span class="fl">.7</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_group_bar</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of people"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="st">"X"</span>, axis <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="st">"X"</span>,</span>
<span>    legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/group-bar-plot-1.png" width="100%"></p>
<p><strong>Plot with labels:</strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with labels</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">group_bar_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">refugees</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">unhcr_region</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    width <span class="op">=</span> <span class="fl">.7</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span></span>
<span>        scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_si</a></span><span class="op">(</span>unit <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>        accuracy <span class="op">=</span> <span class="fl">.1</span></span>
<span>      <span class="op">)</span><span class="op">(</span><span class="va">refugees</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="op">-</span><span class="fl">.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_group_bar</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="cn">FALSE</span>, axis <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    axis_text <span class="op">=</span> <span class="st">"Y"</span>, legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/group-bar-label-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="stacked-bar-chart">Stacked bar chart<a class="anchor" aria-label="anchor" href="#stacked-bar-chart"></a>
</h3>
<p>Let’s make a stacked bar chart comparing the top 10 countries of
origin for all people displaced across borders, by type, in 2022.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep only 2022 records, Summarize popolutaion type by coo,</span></span>
<span><span class="co"># Keep only top 10, Pivot for ggplot2,</span></span>
<span><span class="co"># Wrap long label and make factor of pop_type, Remove 0</span></span>
<span><span class="va">stack_bar_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    oip <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">oip</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    asy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">asylum_seekers</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    tot <span class="op">=</span> <span class="va">ref</span> <span class="op">+</span> <span class="va">oip</span> <span class="op">+</span> <span class="va">asy</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">coo_name</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">tot</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ref</span>, <span class="va">oip</span>, <span class="va">asy</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"pop_type"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"pop_num"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    coo_name <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html" class="external-link">str_wrap</a></span><span class="op">(</span><span class="va">coo_name</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>    pop_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">pop_type</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"oip"</span>, <span class="st">"asy"</span>, <span class="st">"ref"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">tot</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pop_num</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title and subtitle</span></span>
<span><span class="va">title_stack_bar</span> <span class="op">&lt;-</span> <span class="st">"Top 10 country of origin of people displaced across borders in 2022"</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">stack_bar_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">pop_num</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">coo_name</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">pop_type</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    width <span class="op">=</span> <span class="fl">0.8</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7e6</span>, by <span class="op">=</span> <span class="fl">1e6</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"pal_unhcr_poc"</span>, nmax <span class="op">=</span> <span class="fl">9</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Other people in need of international protection"</span>, <span class="st">"Asylum-seekers"</span>, <span class="st">"Refugees"</span><span class="op">)</span>,</span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_stack_bar</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of people"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="st">"X"</span>, axis <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="st">"X"</span>,</span>
<span>    legend_text_size <span class="op">=</span> <span class="fl">9</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/stack-bar-plot-1.png" width="100%"></p>
<p><strong>Plot with labels:</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add subtitle instead of legend</span></span>
<span><span class="va">subtitle_stack_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"People displaced across borders asr composed of &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span>, <span class="st">"pal_unhcr_poc"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  <span class="st">"'&gt;Refugees&lt;/span&gt;, &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span>, <span class="st">"pal_unhcr_poc"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  <span class="st">"'&gt;Asylum-seekers&lt;/span&gt; and &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span>, <span class="st">"pal_unhcr_poc"</span><span class="op">)</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>,</span>
<span>  <span class="st">"'&gt;Other people in need of international protection&lt;/span&gt;."</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot with labels</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">stack_bar_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">pop_num</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">coo_name</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">pop_type</span>,</span>
<span>    group <span class="op">=</span> <span class="va">pop_type</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>        <span class="va">pop_num</span> <span class="op">&gt;=</span> <span class="fl">1e6</span> <span class="op">~</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span></span>
<span>          scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_si</a></span><span class="op">(</span>unit <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>          accuracy <span class="op">=</span> <span class="fl">.1</span></span>
<span>        <span class="op">)</span><span class="op">(</span><span class="va">pop_num</span><span class="op">)</span>,</span>
<span>        <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span></span>
<span>          scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_si</a></span><span class="op">(</span>unit <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>          accuracy <span class="op">=</span> <span class="fl">1</span></span>
<span>        <span class="op">)</span><span class="op">(</span><span class="va">pop_num</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      hjust <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>        <span class="va">pop_num</span> <span class="op">&lt;</span> <span class="fl">2e5</span> <span class="op">&amp;</span> <span class="va">pop_type</span> <span class="op">==</span> <span class="st">"asy"</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.25</span>,</span>
<span>        <span class="va">pop_num</span> <span class="op">&lt;</span> <span class="fl">5e5</span> <span class="op">&amp;</span> <span class="va">pop_type</span> <span class="op">==</span> <span class="st">"asy"</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.55</span>,</span>
<span>        <span class="va">pop_num</span> <span class="op">&lt;</span> <span class="fl">5e5</span> <span class="op">&amp;</span> <span class="va">pop_type</span> <span class="op">==</span> <span class="st">"ref"</span> <span class="op">~</span> <span class="fl">0.15</span>,</span>
<span>        <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">.5</span></span>
<span>      <span class="op">)</span>,</span>
<span>      color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>        <span class="va">pop_num</span> <span class="op">&lt;</span> <span class="fl">5e5</span> <span class="op">&amp;</span> <span class="va">pop_type</span> <span class="op">==</span> <span class="st">"asy"</span> <span class="op">~</span> <span class="st">"#1a1a1a"</span>,</span>
<span>        <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"#ffffff"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_stack</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">9</span> <span class="op">/</span> <span class="va">.pt</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"pal_unhcr_poc"</span>, nmax <span class="op">=</span> <span class="fl">9</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_color_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_stack_bar</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="va">subtitle_stack_bar</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="cn">FALSE</span>, axis <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    axis_text <span class="op">=</span> <span class="st">"y"</span>, legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/stack-bar-label-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="population-pyramid">Population pyramid<a class="anchor" aria-label="anchor" href="#population-pyramid"></a>
</h3>
<p>This type of chart is perfect to represent age &amp; gender
disagregation. Let’s make a population pyramid of populations protected
and/or assisted by UNHCR in 2022.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter 2022 records, Keep only relevant pop_type,</span></span>
<span><span class="co"># Summarise age group, pivot and separate age/gender,</span></span>
<span><span class="co"># Calculate percent, put ages in a factor</span></span>
<span><span class="va">pyramid_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/demographics.html" class="external-link">demographics</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span> <span class="op">&amp;</span></span>
<span>    <span class="va">pop_type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"REF"</span>, <span class="st">"ASY"</span>, <span class="st">"IDP"</span>, <span class="st">"OIP"</span>, <span class="st">"RDP"</span>, <span class="st">"RET"</span>, <span class="st">"STA"</span>, <span class="st">"OOC"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    <span class="st">"male 0-4"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">m_0_4</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="st">"male 5-11"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">m_5_11</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="st">"male 12-17"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">m_12_17</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="st">"male 18-59"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">m_18_59</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="st">"male 60+"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">m_60</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="st">"female 0-4"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">f_0_4</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="st">"female 5-11"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">f_5_11</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="st">"female 12-17"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">f_12_17</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="st">"female 18-59"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">f_18_59</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="st">"female 60+"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">f_60</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    names_sep <span class="op">=</span> <span class="st">" "</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".value"</span>, <span class="st">"ages"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    male_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">male</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">female</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">male</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    female_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">female</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">female</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">male</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    ages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ages</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0-4"</span>, <span class="st">"5-11"</span>, <span class="st">"12-17"</span>, <span class="st">"18-59"</span>, <span class="st">"60+"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">pyramid_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ages</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="va">male_p</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_navy"</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">.7</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">female_p</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">.7</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="op">-</span><span class="va">male_p</span>,</span>
<span>      label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">male_p</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">1.25</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_navy"</span><span class="op">)</span>,</span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">female_p</span>,</span>
<span>      label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">female_p</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="op">-</span><span class="fl">.25</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Demographics of populations protected and/or assisted by UNHCR at the end of 2022"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Note: Age and sex disaggregated data is not available for all countries of asylum. Figures do not add up to 100 per cent due to rounding.&lt;br&gt;Source: UNHCR Refugee Data Finder - © UNHCR, The UN Refugee Agency"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">.01</span>, y <span class="op">=</span> <span class="fl">5.65</span>, label <span class="op">=</span> <span class="st">"Male"</span>, size <span class="op">=</span> <span class="fl">12</span> <span class="op">/</span> <span class="va">.pt</span>, family <span class="op">=</span> <span class="st">"Lato"</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_navy"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">.01</span>, y <span class="op">=</span> <span class="fl">5.65</span>, label <span class="op">=</span> <span class="st">"Female"</span>, size <span class="op">=</span> <span class="fl">12</span> <span class="op">/</span> <span class="va">.pt</span>, family <span class="op">=</span> <span class="st">"Lato"</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    axis_text <span class="op">=</span> <span class="st">"Y"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>, grid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    plot_title_margin <span class="op">=</span> <span class="fl">24</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/pyramid-plot-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="column-chart">Column chart<a class="anchor" aria-label="anchor" href="#column-chart"></a>
</h2>
<div class="section level3">
<h3 id="single-column-chart">Single column chart<a class="anchor" aria-label="anchor" href="#single-column-chart"></a>
</h3>
<p>A column chart is quite similar to a bar chart, but the bars are
vertical. Let’s make a column chart of the last 10 years of total
refugee population.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep only 2013-2022 records, Sum refugees, Make year factor</span></span>
<span><span class="va">column_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2013</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    refugees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">year</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title</span></span>
<span><span class="va">title_column</span> <span class="op">&lt;-</span> <span class="st">"Total number of refugees | 2013-2022"</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">column_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">refugees</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.8</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30e6</span>, by <span class="op">=</span> <span class="fl">5e6</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_column</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span>,</span>
<span>    Y <span class="op">=</span> <span class="st">"Number of people"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/column-plot-1.png" width="100%"></p>
<p><strong>Plot with labels:</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with labels</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">column_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">refugees</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.8</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span></span>
<span>        scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        accuracy <span class="op">=</span> <span class="fl">.1</span></span>
<span>      <span class="op">)</span><span class="op">(</span><span class="va">refugees</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">.4</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30e6</span>, by <span class="op">=</span> <span class="fl">5e6</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_column</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span>,</span>
<span>    Y <span class="op">=</span> <span class="st">"Number of people"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="cn">FALSE</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>, axis_text <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/column-label-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="grouped-column-chart">Grouped column chart<a class="anchor" aria-label="anchor" href="#grouped-column-chart"></a>
</h3>
<p>Let’s compare the 2018-2022 refugee population, originating in the
three UNHCR regions in Africa. We will use a grouped column chart.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep 2018-2022 records, Load and join region names,</span></span>
<span><span class="co"># Group by year and region and sum refugees,</span></span>
<span><span class="co"># Keep only regions in Africa</span></span>
<span><span class="va">group_col_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2018</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/countries.html" class="external-link">countries</a></span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coo_iso"</span> <span class="op">=</span> <span class="st">"iso_code"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">unhcr_region</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>refugees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">unhcr_region</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"East and Horn of Africa"</span>,</span>
<span>    <span class="st">"Southern Africa"</span>,</span>
<span>    <span class="st">"West and Central Africa"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title</span></span>
<span><span class="va">region_name</span> <span class="op">&lt;-</span> <span class="va">group_col_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">unhcr_region</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">unhcr_region</span><span class="op">)</span></span>
<span></span>
<span><span class="va">title_group_col</span> <span class="op">&lt;-</span> <span class="st">"Refugees from the different regions of Africa"</span></span>
<span></span>
<span><span class="va">subtitle_group_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"Number of refugees in &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, <span class="st">"pal_unhcr_region"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"'&gt;"</span>,</span>
<span>  <span class="va">region_name</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"&lt;/span&gt;, &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, <span class="st">"pal_unhcr_region"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"'&gt;"</span>,</span>
<span>  <span class="va">region_name</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"&lt;/span&gt; and &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, <span class="st">"pal_unhcr_region"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="st">"'&gt;"</span>,</span>
<span>  <span class="va">region_name</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="st">"&lt;/span&gt; at the end of 2018-2022"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">group_col_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">refugees</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">unhcr_region</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    width <span class="op">=</span> <span class="fl">.7</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"pal_unhcr_region"</span>, nmax <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_group_col</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="va">subtitle_group_col</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of people"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/group-col-plot-1.png" width="100%"></p>
<p><strong>Plot with labels:</strong></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with labels</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">group_col_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">refugees</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">unhcr_region</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    width <span class="op">=</span> <span class="fl">.7</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span></span>
<span>        scale <span class="op">=</span> <span class="fl">.000001</span>,</span>
<span>        accuracy <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>        suffix <span class="op">=</span> <span class="st">"M"</span></span>
<span>      <span class="op">)</span><span class="op">(</span><span class="va">refugees</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span>,</span>
<span>    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">.3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"pal_unhcr_region"</span>, nmax <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_group_col</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="va">subtitle_group_col</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of people"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="cn">FALSE</span>, axis_text <span class="op">=</span> <span class="st">"x"</span>, axis <span class="op">=</span> <span class="st">"X"</span>,</span>
<span>    axis_title <span class="op">=</span> <span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/group-col-label-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="stacked-column-chart">Stacked column chart<a class="anchor" aria-label="anchor" href="#stacked-column-chart"></a>
</h3>
<p>Let’s plot the forcibly displaced people by type of population from
2013 to 2022.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># UNHCR data: Keep 2013-2022 records, pivot longer pop_type,</span></span>
<span><span class="co"># Summarise by year and pop_type, drop 0s, rename pop_type</span></span>
<span><span class="va">unhcr_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2013</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">refugees</span>, <span class="va">oip</span>, <span class="va">asylum_seekers</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"pop_type"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"pop_num"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>pop_num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pop_num</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">pop_type</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pop_num</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># IDMC data: Keep 2013-2022 records,</span></span>
<span><span class="co"># Summarise by year, create pop_type</span></span>
<span><span class="va">idmc_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/idmc.html" class="external-link">idmc</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2013</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>pop_num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pop_type <span class="op">=</span> <span class="st">"idmc"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># UNRWA data: Keep 2013-2022 records,</span></span>
<span><span class="co"># Summarise by year, create pop_type</span></span>
<span><span class="va">unrwa_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/unrwa.html" class="external-link">unrwa</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2013</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>pop_num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pop_type <span class="op">=</span> <span class="st">"unrwa"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Append dataframes together, level factor pop_type, make year factor</span></span>
<span><span class="va">stack_col_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">unhcr_df</span>, <span class="va">idmc_df</span>, <span class="va">unrwa_df</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    pop_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">pop_type</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"idmc"</span>,</span>
<span>      <span class="st">"refugees"</span>,</span>
<span>      <span class="st">"unrwa"</span>,</span>
<span>      <span class="st">"oip"</span>,</span>
<span>      <span class="st">"asylum_seekers"</span></span>
<span>    <span class="op">)</span><span class="op">)</span>,</span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title</span></span>
<span><span class="va">stack_col_title</span> <span class="op">&lt;-</span> <span class="st">"People forced to flee worldwide | 2013-2022"</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">stack_col_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">pop_num</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">pop_type</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    width <span class="op">=</span> <span class="fl">.7</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_stack</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"pal_unhcr_poc"</span>, nmax <span class="op">=</span> <span class="fl">9</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"IDPs"</span>,</span>
<span>      <span class="st">"Refugees under\nUNHCR's mandate"</span>,</span>
<span>      <span class="st">"Refugees under\nUNRWA's mandate"</span>,</span>
<span>      <span class="st">"Other people in need\nof international protection"</span>,</span>
<span>      <span class="st">"Asylum-seekers"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">stack_col_title</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    legend_text_size <span class="op">=</span> <span class="fl">9</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/stack-col-plot-1.png" width="100%"></p>
<p><strong>Plot with category in subtitle:</strong></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set subtitle</span></span>
<span><span class="va">stack_col_subtitle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"By: &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span>, <span class="st">"pal_unhcr_poc"</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>  <span class="st">"'&gt;IDPs&lt;/span&gt;, &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span>, <span class="st">"pal_unhcr_poc"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  <span class="st">"'&gt;Refugees under UNHCR's mandate&lt;/span&gt;, &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span>, <span class="st">"pal_unhcr_poc"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  <span class="st">"'&gt;Refugees under UNWRA's mandate&lt;/span&gt;,&lt;br&gt;&lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span>, <span class="st">"pal_unhcr_poc"</span><span class="op">)</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>,</span>
<span>  <span class="st">"'&gt;Other people in need of international protection&lt;/span&gt; and &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span>, <span class="st">"pal_unhcr_poc"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>  <span class="st">"'&gt;Asylum-seekers&lt;/span&gt;."</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot with labels</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">stack_col_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">pop_num</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">pop_type</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    width <span class="op">=</span> <span class="fl">.7</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_stack</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"pal_unhcr_poc"</span>, nmax <span class="op">=</span> <span class="fl">9</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">stack_col_title</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="va">stack_col_subtitle</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/stack-col-label-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="stacked-column-chart-1">100% stacked column chart<a class="anchor" aria-label="anchor" href="#stacked-column-chart-1"></a>
</h3>
<p>Let’s create a 100% stacked column chart showing the total refugee
population for the last 10 years, by the each of the three UNHCR regions
in Africa.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep 2013-2022 records, Load and join region names,</span></span>
<span><span class="co"># Keep only regions in Africa, Group by year and region and sum refugees,</span></span>
<span><span class="co"># Group by year and calculate percent, make year as factor</span></span>
<span><span class="va">percent_stack_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2013</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/countries.html" class="external-link">countries</a></span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coo_iso"</span> <span class="op">=</span> <span class="st">"iso_code"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">unhcr_region</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"East and Horn of Africa"</span>,</span>
<span>    <span class="st">"Southern Africa"</span>,</span>
<span>    <span class="st">"West and Central Africa"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">unhcr_region</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>refugees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>refugees <span class="op">=</span> <span class="va">refugees</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title</span></span>
<span><span class="va">region_name</span> <span class="op">&lt;-</span> <span class="va">percent_stack_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">unhcr_region</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">unhcr_region</span><span class="op">)</span></span>
<span></span>
<span><span class="va">title_percent_stack</span> <span class="op">&lt;-</span> <span class="st">"Refugees from the different regions of Africa"</span></span>
<span></span>
<span><span class="va">subtitle_percent_stack</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"Percentage of refugees in &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, <span class="st">"pal_unhcr_region"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"'&gt;"</span>,</span>
<span>  <span class="va">region_name</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"&lt;/span&gt;, &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, <span class="st">"pal_unhcr_region"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"'&gt;"</span>,</span>
<span>  <span class="va">region_name</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"&lt;/span&gt; and &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, <span class="st">"pal_unhcr_region"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="st">"'&gt;"</span>,</span>
<span>  <span class="va">region_name</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="st">"&lt;/span&gt; that originated from these regions at the end of 2013-2022"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">percent_stack_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">refugees</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">unhcr_region</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    width <span class="op">=</span> <span class="fl">.7</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">label_percent</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"pal_unhcr_region"</span>, nmax <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_percent_stack</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="va">subtitle_percent_stack</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/percent-stack-plot-1.png" width="100%"></p>
<p><strong>Plot with labels:</strong></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with labels</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">percent_stack_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">refugees</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">unhcr_region</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    width <span class="op">=</span> <span class="fl">.7</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">label_percent</a></span><span class="op">(</span></span>
<span>        accuracy <span class="op">=</span> <span class="fl">.1</span></span>
<span>      <span class="op">)</span><span class="op">(</span><span class="va">refugees</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_stack</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>      <span class="va">percent_stack_df</span><span class="op">$</span><span class="va">unhcr_region</span> <span class="op">==</span> <span class="st">"West and Central Africa"</span>,</span>
<span>      <span class="st">"#1a1a1a"</span>,</span>
<span>      <span class="st">"#ffffff"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">label_percent</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"pal_unhcr_region"</span>, nmax <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_percent_stack</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="va">subtitle_percent_stack</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="cn">FALSE</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    axis_text <span class="op">=</span> <span class="st">"x"</span>, legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/percent-stack-label-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="line-chart">Line chart<a class="anchor" aria-label="anchor" href="#line-chart"></a>
</h2>
<div class="section level3">
<h3 id="single-line-chart">Single line chart<a class="anchor" aria-label="anchor" href="#single-line-chart"></a>
</h3>
<p>Let’s plot the evolution of the total refugee population from 1993 to
2022.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep data from 1993 to 2022,</span></span>
<span><span class="co"># Sum refugees by year, year as factor</span></span>
<span><span class="va">single_line_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">1993</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    refugees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">year</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title</span></span>
<span><span class="va">title_single_line</span> <span class="op">&lt;-</span> <span class="st">"Total number of refugees | 1993-2022"</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">single_line_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">refugees</span>,</span>
<span>    group <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_single_line</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/single-line-plot-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="multiple-line-chart">Multiple line chart<a class="anchor" aria-label="anchor" href="#multiple-line-chart"></a>
</h3>
<p>Let’s plot the evolution of the total refugee and IDP population from
1993 to 2022.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep data from 1993 to 2022, Sum refugees and IDPs by year,</span></span>
<span><span class="co"># Pivot longer, year as factor</span></span>
<span><span class="va">multi_line_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">1993</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    refugees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    idps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">idps</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">year</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">refugees</span>, <span class="va">idps</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"pop_type"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"pop_num"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>,</span>
<span>    pop_type <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">pop_type</span> <span class="op">==</span> <span class="st">"refugees"</span>, <span class="st">"Refugees"</span>, <span class="st">"IDPs"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title</span></span>
<span><span class="va">title_multi_line</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"Total number of &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>, <span class="st">"'&gt;"</span>,</span>
<span>  <span class="st">"refugees&lt;/span&gt; and &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_green"</span><span class="op">)</span>, <span class="st">"'&gt;"</span>,</span>
<span>  <span class="st">"IDPs&lt;/span&gt; | 1993-2022"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">multi_line_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">pop_num</span>,</span>
<span>    color <span class="op">=</span> <span class="va">pop_type</span>,</span>
<span>    group <span class="op">=</span> <span class="va">pop_type</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    size <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6e7</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6e7</span>, by <span class="op">=</span> <span class="fl">1e7</span><span class="op">)</span>,</span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.05</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_color_unhcr_d</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"pal_unhcr"</span>, nmax <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_multi_line</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/multi-line-plot-1.png" width="100%"></p>
<p><strong>Plot with labels:</strong></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with labels</span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">multi_line_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">pop_num</span>,</span>
<span>    color <span class="op">=</span> <span class="va">pop_type</span>,</span>
<span>    group <span class="op">=</span> <span class="va">pop_type</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    size <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">multi_line_df</span>, <span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="va">pop_type</span></span>
<span>    <span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6e7</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6e7</span>, by <span class="op">=</span> <span class="fl">1e7</span><span class="op">)</span>,</span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.05</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_color_unhcr_d</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"pal_unhcr"</span>, nmax <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_multi_line</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    plot_margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">40</span>, <span class="fl">12</span>, <span class="fl">12</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/multi-line-label-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="area-chart">Area chart<a class="anchor" aria-label="anchor" href="#area-chart"></a>
</h2>
<div class="section level3">
<h3 id="single-area-chart">Single area chart<a class="anchor" aria-label="anchor" href="#single-area-chart"></a>
</h3>
<p>Let’s plot the evolution of the total refugee population from 1993 to
2022.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep data from 1993 to 2022,</span></span>
<span><span class="co"># Sum refugees by year, year as factor</span></span>
<span><span class="va">area_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">1993</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    refugees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">year</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title</span></span>
<span><span class="va">title_area</span> <span class="op">&lt;-</span> <span class="st">"Total number of refugees | 1993-2022"</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">area_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">refugees</span>,</span>
<span>    group <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_single_line</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/area-plot-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="stacked-area-chart">Stacked area chart<a class="anchor" aria-label="anchor" href="#stacked-area-chart"></a>
</h3>
<p>Let’s plot the evolution of the total refugee and IDP population from
1993 to 2022.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep data from 1993 to 2022, Sum refugees and IDPs by year,</span></span>
<span><span class="co"># Pivot longer, year as factor</span></span>
<span><span class="va">stack_area_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">1993</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    refugees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    idps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">idps</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">year</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">refugees</span>, <span class="va">idps</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"pop_type"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"pop_num"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>,</span>
<span>    pop_type <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">pop_type</span> <span class="op">==</span> <span class="st">"refugees"</span>, <span class="st">"Refugees"</span>, <span class="st">"IDPs"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title</span></span>
<span><span class="va">title_stack_area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"Total number of &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>, <span class="st">"'&gt;"</span>,</span>
<span>  <span class="st">"refugees&lt;/span&gt; and &lt;span style='color:"</span>,</span>
<span>  <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_green"</span><span class="op">)</span>, <span class="st">"'&gt;"</span>,</span>
<span>  <span class="st">"IDPs&lt;/span&gt; | 1993-2022"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">stack_area_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">pop_num</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">pop_type</span>,</span>
<span>    group <span class="op">=</span> <span class="va">pop_type</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.05</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"pal_unhcr"</span>, nmax <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_stack_area</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of people"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="st">"Y"</span>, axis <span class="op">=</span> <span class="st">"X"</span>, axis_title <span class="op">=</span> <span class="st">"y"</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/stack-area-plot-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="pie-chart">Pie chart<a class="anchor" aria-label="anchor" href="#pie-chart"></a>
</h2>
<p>Let’s plot the percentage of women vs men for all population of
concern by the end of 2022.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter 2022 records, Keep only relevant pop_type,</span></span>
<span><span class="co"># Summarise by gender, pivot longer,</span></span>
<span><span class="co"># Calculate percentage</span></span>
<span><span class="va">pie_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/demographics.html" class="external-link">demographics</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span> <span class="op">&amp;</span></span>
<span>    <span class="va">pop_type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"REF"</span>, <span class="st">"ASY"</span>, <span class="st">"IDP"</span>, <span class="st">"OIP"</span>, <span class="st">"RDP"</span>, <span class="st">"RET"</span>, <span class="st">"STA"</span>, <span class="st">"OOC"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    <span class="st">"Male"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">m_total</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="st">"Female"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">f_total</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"gender"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    percent <span class="op">=</span> <span class="va">value</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title</span></span>
<span><span class="va">pie_title</span> <span class="op">&lt;-</span></span>
<span>  <span class="st">"Demographics of populations protected and/or assisted by UNHCR at the end of 2022"</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">pie_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    y <span class="op">=</span> <span class="va">percent</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">gender</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">gender</span>, <span class="st">"\n"</span>, <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">label_percent</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">percent</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">percent</span><span class="op">)</span> <span class="op">-</span> <span class="va">percent</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"#ffffff"</span>,</span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span></span>
<span>    nmax <span class="op">=</span> <span class="fl">3</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html" class="external-link">coord_polar</a></span><span class="op">(</span></span>
<span>    theta <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>    direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">pie_title</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span>void <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/pie-plot-1.png" width="100%"></p>
<p><strong>Donut Plot:</strong></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">pie_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    y <span class="op">=</span> <span class="va">percent</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">gender</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">gender</span>, <span class="st">"\n"</span>, <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">label_percent</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">percent</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">percent</span><span class="op">)</span> <span class="op">-</span> <span class="va">percent</span> <span class="op">/</span> <span class="fl">2</span>,</span>
<span>      color <span class="op">=</span> <span class="va">gender</span></span>
<span>    <span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">1.8</span>,</span>
<span>    fontface <span class="op">=</span> <span class="st">"bold"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span></span>
<span>    nmax <span class="op">=</span> <span class="fl">3</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_color_unhcr_d</a></span><span class="op">(</span></span>
<span>    nmax <span class="op">=</span> <span class="fl">3</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html" class="external-link">coord_polar</a></span><span class="op">(</span></span>
<span>    theta <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>    direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>    clip <span class="op">=</span> <span class="st">"off"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">pie_title</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span>void <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/donut-plot-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="less-common-charts">Less common charts<a class="anchor" aria-label="anchor" href="#less-common-charts"></a>
</h2>
<p>These less common type of charts can be created with the help of the
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> and <a href="https://github.com/unhcr-dataviz/unhcrthemes" class="external-link">unhcrthemes</a> packages but will
require extra packages. When needed, the code to install the extra
packages will be provided.</p>
<div class="section level3">
<h3 id="treemap">Treemap<a class="anchor" aria-label="anchor" href="#treemap"></a>
</h3>
<p>Let’s make a treemap of the refugee population by region of origin in
2022. For this we will use the <a href="https://github.com/wilkox/treemapify" class="external-link"><code>{treemapify}</code></a>
package.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep 2022 records, Load and join region names,</span></span>
<span><span class="co"># Group by region and sum refugees, Remove NAs</span></span>
<span><span class="va">treemap_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/countries.html" class="external-link">countries</a></span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coo_iso"</span> <span class="op">=</span> <span class="st">"iso_code"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">unhcr_region</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>refugees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="va">unhcr_region</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install if needed and load package</span></span>
<span><span class="co"># install.packages("treemapify")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkox.org/treemapify/" class="external-link">treemapify</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set title</span></span>
<span><span class="va">title_treemap</span> <span class="op">&lt;-</span> <span class="st">"Number of refugees by region of origin | 2022"</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">treemap_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">refugees</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">treemapify</span><span class="fu">::</span><span class="fu"><a href="https://wilkox.org/treemapify/reference/geom_treemap.html" class="external-link">geom_treemap</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="st">"#FFFFFF"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>    start <span class="op">=</span> <span class="st">"topleft"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">treemapify</span><span class="fu">::</span><span class="fu"><a href="https://wilkox.org/treemapify/reference/geom_treemap_text.html" class="external-link">geom_treemap_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="va">unhcr_region</span>, <span class="st">"\n"</span>,</span>
<span>      <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_si</a></span><span class="op">(</span>unit <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">refugees</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"#FFFFFF"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">9</span>,</span>
<span>    lineheight <span class="op">=</span> <span class="fl">1.1</span>,</span>
<span>    start <span class="op">=</span> <span class="st">"topleft"</span>,</span>
<span>    family <span class="op">=</span> <span class="st">"Lato"</span>,</span>
<span>    padding.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">title_treemap</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span>void <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/teeemap-plot-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="streamgraph">Streamgraph<a class="anchor" aria-label="anchor" href="#streamgraph"></a>
</h3>
<p>Let’s make a streamgraph showing the evolution of the populations
assisted by UNHCR from 1993 to 2022. For this we will use the <a href="https://github.com/davidsjoberg/ggstream" class="external-link"><code>{ggstream}</code></a>
package.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep 1993-2022 records, rename population columns,</span></span>
<span><span class="co"># Pivot longer, grou by year and pop_type</span></span>
<span><span class="co"># year as factor, pop_type as factor with levels, drop 0s</span></span>
<span><span class="va">stream_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">1993</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">year</span>,</span>
<span>    <span class="st">"Refugees"</span> <span class="op">=</span> <span class="va">refugees</span>,</span>
<span>    <span class="st">"IDPs"</span> <span class="op">=</span> <span class="va">idps</span>,</span>
<span>    <span class="st">"Asylum-seekers"</span> <span class="op">=</span> <span class="va">asylum_seekers</span>,</span>
<span>    <span class="st">"Stateless person"</span> <span class="op">=</span> <span class="va">stateless</span>,</span>
<span>    <span class="st">"Other of concern"</span> <span class="op">=</span> <span class="va">ooc</span>,</span>
<span>    <span class="st">"Other people in need of international protection"</span> <span class="op">=</span> <span class="va">oip</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Refugees"</span>,</span>
<span>      <span class="st">"IDPs"</span>,</span>
<span>      <span class="st">"Asylum-seekers"</span>,</span>
<span>      <span class="st">"Stateless person"</span>,</span>
<span>      <span class="st">"Other of concern"</span>,</span>
<span>      <span class="st">"Other people in need of international protection"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"pop_type"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"pop_num"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">pop_type</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>pop_num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pop_num</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>,</span>
<span>    pop_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">pop_type</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Refugees"</span>,</span>
<span>      <span class="st">"Asylum-seekers"</span>,</span>
<span>      <span class="st">"IDPs"</span>,</span>
<span>      <span class="st">"Stateless person"</span>,</span>
<span>      <span class="st">"Other of concern"</span>,</span>
<span>      <span class="st">"Other people in need of international protection"</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pop_num</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install if needed and load package</span></span>
<span><span class="co"># install.packages("ggstream")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ggstream</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set title</span></span>
<span><span class="va">stream_title</span> <span class="op">&lt;-</span> <span class="st">"Populations protected and/or assisted by UNHCR | 1993-2022"</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">stream_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">pop_num</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">pop_type</span>,</span>
<span>    group <span class="op">=</span> <span class="va">pop_type</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggstream</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggstream/man/geom_stream.html" class="external-link">geom_stream</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/unhcr_scale.html">scale_fill_unhcr_d</a></span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"pal_unhcr_poc"</span>,</span>
<span>    nmax <span class="op">=</span> <span class="fl">9</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">8</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_short_scale</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">stream_title</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of people"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    axis_title <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>    legend_text_size <span class="op">=</span> <span class="fl">9</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/stream-plot-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="slope">Slope<a class="anchor" aria-label="anchor" href="#slope"></a>
</h3>
<p>Let’s create a slope chart showing the evolution of the total refugee
population between 2017 and 2022 in the countries from the East and Horn
of Africa region.</p>
<p><strong>Preparing the data:</strong></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep only 2017 and 2022 records, Load and join region names,</span></span>
<span><span class="co"># Keep only countries in East and Horn of Africa region,</span></span>
<span><span class="co"># Group by country and year and sum refugees</span></span>
<span><span class="va">slope_df</span> <span class="op">&lt;-</span> <span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/population.html" class="external-link">population</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2017</span> <span class="op">|</span> <span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu">refugees</span><span class="fu">::</span><span class="va"><a href="https://github.com/PopulationStatistics/refugees/reference/countries.html" class="external-link">countries</a></span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coo_iso"</span> <span class="op">=</span> <span class="st">"iso_code"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">unhcr_region</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"East and Horn of Africa"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">coo_name</span>, <span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>refugees <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">refugees</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot:</strong></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set title</span></span>
<span><span class="va">slope_title</span> <span class="op">&lt;-</span> <span class="st">"Evolution of refugee population in East and Horn of Africa region | 2017 vs 2022"</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">slope_df</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="va">refugees</span>,</span>
<span>    group <span class="op">=</span> <span class="va">coo_name</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="fu"><a href="../reference/unhcr_pal.html">unhcr_pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, <span class="st">"pal_blue"</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">coo_name</span>, <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span></span>
<span>        scale_cut <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/number.html" class="external-link">cut_si</a></span><span class="op">(</span>unit <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>        accuracy <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">refugees</span> <span class="op">&gt;=</span> <span class="fl">1e6</span>, <span class="fl">.1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>      <span class="op">)</span><span class="op">(</span><span class="va">refugees</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">slope_df</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2017</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">slope_df</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2017</span>, <span class="op">-</span><span class="fl">.3</span>, <span class="fl">.3</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2017</span>, <span class="fl">2022</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2014</span>, <span class="fl">2025</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="va">slope_title</span>,</span>
<span>    caption <span class="op">=</span> <span class="va">caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_unhcr.html">theme_unhcr</a></span><span class="op">(</span></span>
<span>    axis_title <span class="op">=</span> <span class="cn">FALSE</span>, axis_text <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>    grid <span class="op">=</span> <span class="st">"X"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="design-unhcr-charts_files/figure-html/slope-plot-1.png" width="100%"></p>
<p>We trust that this R package has equipped you with the tools needed
to craft visually appealing and on-brand charts with ease. Should you
desire further inspiration or in-depth guidance on aligning your data
visualizations with UNHCR branding standards, we invite you to explore
our <a href="https://dataviz.unhcr.org" class="external-link">UNHCR data visualization
platform</a>. There, you will discover a multitude of <a href="https://dataviz.unhcr.org/tools/r/" class="external-link">practical examples</a>
showcasing the package’s capabilities in action. Furthermore, you can
delve into our comprehensive <a href="https://dataviz.unhcr.org/general_guidance/" class="external-link">data visualization
guidelines</a>, which offer invaluable insights into UNHCR’s brand
recommendations for charts, ensuring that your visualizations harmonize
perfectly with the organization’s identity and mission.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cédric Vidonne, Ahmadou Dicko.</p>
</div>

<div class="pkgdown-footer-right">
  <p><a href="https://www.unhcr.org/" target="_blank" rel="noopener noreferrer" class="external-link"><img src="https://raw.githubusercontent.com/unhcr-dataviz/unhcrtemplate/master/man/figures/logo.svg" alt="UNHCR logo" style="max-height:2.5rem"></a></p>
</div>

    </footer>
</div>





  </body>
</html>
